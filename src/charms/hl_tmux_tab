#!/usr/bin/env zsh
set -eo pipefail

if [[ -z "$TMUX" ]]; then
  print "This script must be run inside tmux"
  exit 1
fi

zparseopts -D -E -F -- \
  -clear=clear \
  -id:=winId \
  || return 1

local action
[[ -n "$clear" ]] && action="clear" || action="highlight"

local targetWin
[[ -n "$winId" ]] && targetWin="-t ${winId[1]}"

local cmd="tmux $action $targetWin"

local rename=$*
if [[ -n "$rename" && -z "$clear" ]]
  then cmd+="\; rename-window '$rename'"
fi

if [[ -n "$clear" ]]
  then cmd+="\; set automatic-rename"
fi

eval $cmd
